---
title: "RMarkdown Assignment Week 7"
author: "Dipika Sharma"
date: May 2nd 2021
output:
  
  pdf_document: default
  html_document: default
  word_document: default
bibliography: bibliography.bib
---

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

## Add Citations

* R for Everyone [@lander2014r]
* Discovering Statistics Using R [@field2012discovering]

## Assignment 05

```{r echo=FALSE, include=TRUE}
## Set the working directory to the root of your DSC 520 directory
setwd("/Users/dipikasharma/R_Projects/DSC520")

## Load the `data/r4ds/heights.csv` to
heights_df <- read.csv("data/r4ds/heights.csv")
```

Using `cor()` compute correlation coefficients for

1. height vs. earn

```{r echo=FALSE, include=TRUE}
cor(heights_df$height, heights_df$earn, method="pearson")
```

2. age vs. earn

```{r echo=FALSE, include=TRUE}
cor(heights_df$age, heights_df$earn, method="pearson")
```

3. ed vs. earn

```{r echo=FALSE, include=TRUE}
cor(heights_df$ed, heights_df$earn, method="pearson")
```

4. Spurious correlation. The following is data on US spending on science, space, and technology in millions of today's dollars and Suicides by hanging strangulation and suffocation for the years 1999 to 2009. Compute the correlation between these variables

```{r echo=FALSE, include=TRUE}
tech_spending <- c(18079, 18594, 19753, 20734, 20831, 23029, 23597, 23584, 25525, 27731, 29449)
suicides <- c(5427, 5688, 6198, 6462, 6635, 7336, 7248, 7491, 8161, 8578, 9000)
cor(tech_spending, suicides, method="pearson")

```

## Student Survey

```{r echo=FALSE, include=TRUE}
## Set the working directory to the root of your DSC 520 directory
setwd("/Users/dipikasharma/R_Projects/DSC520")

## Load the `data/student-survey.csv` to
ssurvey_df <- read.csv("data/student-survey.csv")

```

### Use R to calculate the covariance of the Survey variables

```{r echo=FALSE, include=TRUE}
cor(ssurvey_df$TimeTV, ssurvey_df$Happiness)
cor(ssurvey_df$TimeReading, ssurvey_df$Happiness)
```

### Provide an explanation of why you would use this calculation and what the results indicate.

Answer: I use cor function to see the relationship between the Time reading with Happiness and Time TV with Happiness. Using Cor function I found that Time TV and Happiness is giving us positive correlation where as Time reading and Happiness is negative correlation which mean more time students spent in watching TV their happiness increases but if student spent more time in reading their happiness decreases.

### Examine the Survey data variables. What measurement is being used for the variables? 

Answer: We have four variables in student survey data.

```{r echo=FALSE, include=TRUE}
str(ssurvey_df)
sapply(ssurvey_df, class)
```

Using str and sapply functions we can clearly see TimeReading, TimeTV and Gender variables are integer where as Happiness is numeric variable.

TimeReading, TimeTV are interval variables. Gender is nominal variable with value 0 or 1 and Happiness is Ratio variable.

### Explain what effect changing the measurement being used for the variables would have on the covariance calculation.

Answer: Depending on the changes it can have significant effect on the covariance or it might have slight changes. Covariance is used to find out the relationship of of 2 variables or we can say finding out the dependency of one variable on other. If we will make any change to any varibale it will have some effect on covariance.

### Would this be a problem? Explain and provide a better alternative if needed.

Answer: I would use nominal variables for Gender - Male and Female. currently we using the numeric value 0 and 1 which is not very clear in this way we can see different relationship between other variables for specific Gender It would be interesting to see if that will change the overall relationship between the variables.

### Choose the type of correlation test to perform.

```{r echo=FALSE, include=TRUE}
cor(ssurvey_df$TimeTV, ssurvey_df$Happiness)
```

### explain why you chose this test?

Answer: I would like to see relationship between time spent on TV and happiness.

### Make a prediction if the test yields a positive or negative correlation?

Answer: It is positive correlation which indicate that if student spent more time watching TV their happiness also increase.

### Perform a correlation analysis of:

1. All variables

```{r echo=FALSE, include=TRUE}
cor(ssurvey_df)
```

2.  A single correlation between two a pair of the variables

```{r echo=FALSE, include=TRUE}
cor.test(ssurvey_df$TimeTV, ssurvey_df$TimeReading, method = "pearson")
```

3. Repeat your correlation test in step 2 but set the confidence interval at 99%

```{r echo=FALSE, include=TRUE}
cor.test(ssurvey_df$TimeTV, ssurvey_df$TimeReading, method = "pearson", conf.level = 0.99)
```

###  Describe what the calculations in the correlation matrix suggest about the relationship between the variables. Be specific with your explanation.

Answer: After looking at the correlation matrix we can clearly see that TimeReading and TimeTV show negative correlation which mean with increase of one variable the second variable will decrease so if student spent more time in watching TV they will spent less time in reading. Hence variables are opposite. If we look at TimeTV and Happiness we see positive correlation, we will see student are more happy, if they spent more time watching TV so if one variable increase the other variable will also increase. Time reading and Happiness is negative correlation which mean if student spent more time in reading their happiness decrease.and lastly all the gender are showing negative correlation with Time reading where as gender are showing positive correlation wit TimeTV and Happiness.

### Calculate the correlation coefficient and the coefficient of determination,

### Correlation coefficient

```{r echo=FALSE, include=TRUE}
cor(ssurvey_df$TimeTV, ssurvey_df$TimeReading, method = "pearson")

r = cor(ssurvey_df$TimeTV, ssurvey_df$TimeReading, method = "pearson")

lm.rel = lm(ssurvey_df$TimeTV~ssurvey_df$TimeReading)
```

### Coefficient of determination

```{r echo=FALSE, include=TRUE}
summary(lm.rel)$r.squared
```

### Describe what you conclude about the results.

Answer: Correlation define the strength of the relationship between an independent and dependent variable and coefficient of determination tell us to what extent the variance of one variable explains the variance of the second variable. In our case coefficient of determination is .77 then approximately 70% of the observed variation can be explained by the inputs.

### Based on your analysis can you say that watching more TV caused students to read less? Explain.

Answer:

```{r echo=FALSE, include=TRUE}
cor(ssurvey_df$TimeTV, ssurvey_df$TimeReading, method = "pearson")
```

Using the Cor function on TimeTV and Time Reading we can cleary see bot variable have negative correlation which stat that if student spent more time in TV then they will spent less time reading. 

### Pick three variables and perform a partial correlation 

```{r echo=FALSE, include=TRUE}
library(ppcor)
pcor.test(ssurvey_df$TimeTV, ssurvey_df$TimeReading, ssurvey_df$Happiness, method = "pearson")
```

### Documenting which variable you are “controlling”. 

Answer: Happiness is the variable we are controlling.

### Explain how this changes your interpretation and explanation of the results.

Answer: We already know that TimeTV and TimeReading are negative correlation that is if one variable increases second variable will decrease. After calculating partial correlation between the two where happiness is the controlling variable. p value is 0.0009 which indicate if we can control happiness the relationship between two can show significant changes and it might improve.


## References

